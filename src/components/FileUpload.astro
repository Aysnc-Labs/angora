---
interface Props {
  state?: 'hover' | 'focus' | 'disabled' | 'dragover';
  variant?: 'dropzone' | 'button';
}

const { state, variant = 'dropzone' } = Astro.props;

function resolveDropzoneClasses(): string {
  const parts = [
    'flex flex-col items-center justify-center gap-3 rounded-lg border-2 border-dashed px-6 py-8 text-center',
  ];

  if (state === 'hover') {
    parts.push('border-muted-foreground bg-muted');
  } else if (state === 'dragover') {
    parts.push('border-primary bg-primary/10');
  } else if (state === 'focus') {
    parts.push('border-input outline-2 outline-ring outline-offset-2');
  } else if (state === 'disabled') {
    parts.push('border-border bg-muted opacity-50 cursor-not-allowed');
  } else if (!state) {
    parts.push(
      'border-input',
      'hover:border-muted-foreground hover:bg-muted',
      'transition-colors duration-fast ease-default',
    );
  } else {
    parts.push('border-input');
  }

  return parts.join(' ');
}

function resolveButtonClasses(): string {
  const parts = [
    'inline-flex items-center gap-2 rounded-md border border-input bg-card px-4 py-2.5 text-sm font-medium text-foreground cursor-pointer',
  ];

  if (state === 'hover') {
    parts.push('border-muted-foreground bg-accent');
  } else if (state === 'focus') {
    parts.push('outline-2 outline-ring outline-offset-2');
  } else if (state === 'disabled') {
    parts.push('opacity-50 cursor-not-allowed');
  } else if (!state) {
    parts.push(
      'hover:border-muted-foreground hover:bg-accent',
      'transition-colors duration-fast ease-default',
    );
  }

  return parts.join(' ');
}
---

{variant === 'dropzone' ? (
  <div data-component="FileUpload" class={resolveDropzoneClasses()} data-state={state || undefined} aria-disabled={state === 'disabled' ? 'true' : undefined}>
    <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="text-muted-foreground">
      <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4" />
      <polyline points="17 8 12 3 7 8" />
      <line x1="12" y1="3" x2="12" y2="15" />
    </svg>
    <div>
      <p class="text-sm font-medium text-foreground">Drop files here or click to upload</p>
      <p class="text-xs text-muted-foreground mt-1">PNG, JPG, PDF up to 10MB</p>
    </div>
  </div>
) : (
  <label data-component="FileUpload" class={resolveButtonClasses()} data-state={state || undefined} aria-disabled={state === 'disabled' ? 'true' : undefined}>
    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4" />
      <polyline points="17 8 12 3 7 8" />
      <line x1="12" y1="3" x2="12" y2="15" />
    </svg>
    Choose file
  </label>
)}
